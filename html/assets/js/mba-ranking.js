
let oneYearSchools = [
  {
    "institute": "Indian School of Business (ISB), Hyderabad",
    "rank": 1,
    "score": 950.3,
    "program_name": "Post Graduate Programme in Management (PGP)",
    "sector": "Pvt"
  },
  {
    "institute": "Indian Institute of Management (IIM) Ahmedabad",
    "rank": 2,
    "score": 949.1,
    "program_name": "Post Graduate Programme in Management for Executives (PGPX)",
    "sector": "Govt"
  },
  {
    "institute": "Indian Institute of Management (IIM) Bangalore",
    "rank": 3,
    "score": 925.4,
    "program_name": "Executive Post Graduate Programme in Management (EPGP)",
    "sector": "Govt"
  },
  {
    "institute": "Indian Institute of Management (IIM) Calcutta",
    "rank": 4,
    "score": 918,
    "program_name": "MBA for Executives Programme (MBAEx)",
    "sector": "Govt"
  },
  {
    "institute": "Indian Institute of Management (IIM) Kozhikode",
    "rank": 5,
    "score": 885.7,
    "program_name": "Post Graduate Programme in Business Leadership (PGP-BL)",
    "sector": "Govt"
  },
  {
    "institute": "Indian Institute of Management (IIM) Indore",
    "rank": 6,
    "score": 865.3,
    "program_name": "Executive Post Graduate Programme in Management (EPGP)",
    "sector": "Govt"
  },
  {
    "institute": "Indian Institute of Management (IIM) Lucknow",
    "rank": 7,
    "score": 834.2,
    "program_name": "International Programme in Management for Executives (IPMX)",
    "sector": "Govt"
  },
  {
    "institute": "S.P. Jain Institute of Management & Research (SPJIMR), Mumbai",
    "rank": 8,
    "score": 805.3,
    "program_name": "Post Graduate Programme in Management (PGPM)",
    "sector": "Pvt"
  },
  {
    "institute": "XLRI Xavier School of Management, Jamshedpur",
    "rank": 9,
    "score": 804.8,
    "program_name": "PGDM (GM), previously known as GMP",
    "sector": "Pvt"
  },
  {
    "institute": "Indian Institute of Management (IIM) Shillong",
    "rank": 10,
    "score": 732.5,
    "program_name": "Post Graduate Certification in Advanced General Management",
    "sector": "Govt"
  },
  {
    "institute": "Management Development Institute (MDI) Gurgaon",
    "rank": 11,
    "score": 791.6,
    "program_name": "Post Graduate Diploma in Management - Business Management (PGDM-BM)",
    "sector": "Pvt"
  },
  {
    "institute": "Great Lakes Institute of Management, Chennai",
    "rank": 12,
    "score": 761.7,
    "program_name": "PGPM - Post Graduate Program in Management",
    "sector": "Pvt"
  },
  {
    "institute": "Indian Institute of Management (IIM) Udaipur",
    "rank": 13,
    "score": 761,
    "program_name": "EMBA - Global Supply Chain Management (GSCM) & Digital Enterprise Management (DEM)",
    "sector": "Govt"
  },
  {
    "institute": "International Management Institute, New Delhi",
    "rank": 14,
    "score": 757.3,
    "program_name": "PGDM (Executive)",
    "sector": "Pvt"
  },
  {
    "institute": "Institute of Management Technology (IMT), Ghaziabad",
    "rank": 15,
    "score": 754.5,
    "program_name": "PGDM ExP",
    "sector": "Pvt"
  },
  {
    "institute": "Xavier Institute of Management (XIMB), XIM University, Bhubaneswar",
    "rank": 16,
    "score": 725.8,
    "program_name": "Executive MBA",
    "sector": "Pvt"
  },
  {
    "institute": "Indian Institute of Foreign Trade (IIFT), New Delhi",
    "rank": 17,
    "score": 721.9,
    "program_name": "Executive Post Graduate Diploma in International Business (EPGDIB)",
    "sector": "Govt"
  },
  {
    "institute": "Great Lakes Institute of Management, Gurgaon",
    "rank": 18,
    "score": 703.2,
    "program_name": "Post Graduate Certificate in Management (PGCM)",
    "sector": "Pvt"
  },
  {
    "institute": "K J Somaiya Institute of Management, Mumbai",
    "rank": 19,
    "score": 695.4,
    "program_name": "MBA-Executive",
    "sector": "Pvt"
  },
  {
    "institute": "SOIL Institute of Management, Gurugram",
    "rank": 20,
    "score": 611.5,
    "program_name": "Post Graduate Program in Manaqement (PGPM)",
    "sector": "Pvt"
  }
]

let exMbaSchools = [
  {
    "institute": "Indian Institute of Management (IIM) Ahmedabad",
    "program_name": "Accelerated General Management Programme-Blended Learning (AGMP-BL)",
    "rank": 1,
    "score": 896.3,
    "sector": "Govt"
  },
  {
    "institute": "Indian Institute of Management (IIM) Bangalore",
    "program_name": "Executive General Management Programme (EGMP)",
    "rank": 2,
    "score": 891.1,
    "sector": "Govt"
  },
  {
    "institute": "Indian School of Business (ISB), Hyderabad",
    "program_name": "General Management Programme (GMP)",
    "rank": 3,
    "score": 873.8,
    "sector": "Pvt"
  },
  {
    "institute": "Indian Institute of Management (IIM) Calcutta",
    "program_name": "Executive Programme in Business Management (EPBM)",
    "rank": 4,
    "score": 873,
    "sector": "Govt"
  },
  {
    "institute": "Indian Institute of Management (IIM) Lucknow",
    "program_name": "General Management Programme for Executives (GMPE)",
    "rank": 5,
    "score": 830,
    "sector": "Govt"
  },
  {
    "institute": "Indian Institute of Management (IIM) Indore",
    "program_name": "General Management Programme for Executives (GMPE)",
    "rank": 6,
    "score": 775,
    "sector": "Govt"
  },
  {
    "institute": "S. P. Jain Institute of Management & Research (SPJIMR)",
    "program_name": "Executive Programme in Business Management (EP-BM)",
    "rank": 7,
    "score": 766.3,
    "sector": "Pvt"
  },
  {
    "institute": "XLRI - Xavier School of Management",
    "program_name": "Postgraduate Certificate in Business Management (PGCBM)",
    "rank": 8,
    "score": 762.5,
    "sector": "Pvt"
  },
  {
    "institute": "Indian Institute of Management (IIM) Kozhikode",
    "program_name": "Professional Certificate Programme In Business Management",
    "rank": 9,
    "score": 760.8,
    "sector": "Govt"
  },
  {
    "institute": "Indian Institute of Management (IIM) Shillong",
    "program_name": "Post Graduate Certification in Advanced General Management",
    "rank": 10,
    "score": 732.5,
    "sector": "Govt"
  },
  {
    "institute": "Indian Institute of Management (IIM) Nagpur",
    "program_name": "Post Graduate Certificate Programme In General Management (PGCPGM)",
    "rank": 11,
    "score": 712.5,
    "sector": "Govt"
  },
  {
    "institute": "Indian Institute of Management (IIM) Kashipur",
    "program_name": "Post Graduate Certificate Programme in Business Management (PGCBM)",
    "rank": 12,
    "score": 690,
    "sector": "Govt"
  },
  {
    "institute": "Indian Institute of Management (IIM) Tiruchirappalli",
    "program_name": "Post Graduate Certificate Programme In Executive General Management",
    "rank": 13,
    "score": 677.5,
    "sector": "Govt"
  },
  {
    "institute": "Institute of Management Technology (IMT), Ghaziabad",
    "program_name": "Executive Program in Business Management",
    "rank": 14,
    "score": 625,
    "sector": "Pvt"
  },
  {
    "institute": "Indian Institute of Management (IIM) Bodh Gaya",
    "program_name": "Executive Certificate Programme In Business Management",
    "rank": 15,
    "score": 605,
    "sector": "Govt"
  }
]
function changeName(name) {
  if (name === 'G') {
    name = 'Govt'
  } else {
    name = 'Pvt'
  }
  return name;
}
async function mbaRankingInit() {
  const table = d3.select('.mba-rankings-data .ranking-data-wrapper').append('table').attr('id', 'ranking-mba-table').attr('class', 'full-width')
  const thead = table.append('thead')
  const tbody = table.append('tbody')
  thead.append('tr').append('th')
  const rows = tbody.append('tr').append('td')

  const tableEx = d3.select('.mba-rankings-data .ranking-data-wrapper.ex-mba').append('table').attr('id', 'ex-mba-table').attr('class', 'full-width')
  const theadEx = tableEx.append('thead')
  const tbodyEx = tableEx.append('tbody')
  theadEx.append('tr').append('th')
  const rowsEx = tbodyEx.append('tr').append('td')
  let itemsPerPage = 5;
  function insertDecimal(num) {
    return Number((num / 10));
  }
  let schoolData = []

  $('#ranking-mba-table').DataTable({
    responsive: true,
    processing: true,
    searching: false,
    bInfo: false,
    "ordering": false,
    "bLengthChange": false,
    scrollX: true,
    'pageLength': itemsPerPage,
    language: {
      searchPlaceholder: "Search here",
      search: "",
      paginate: {
        next: '<img src="assets/img/right-arrow-dark.png" class="arrow right">',
        previous: '<img src="assets/img/right-arrow-dark.png" class="arrow left">',
      },
    },
    data: oneYearSchools,
    columns: [
      {
        render: (data, type, row) => {
          return `<div class="school-detail"><div class="d-flex ai-center jc-space-b"><div class="d-flex ai-center"><svg class="rank" width="52" height="33" viewBox="0 0 52 33" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_221_6253)"><path d="M0 0.5V32.6104H51.791L42.8895 16.5552L51.791 0.5H0Z" fill="#D3C375"/><path d="M0 28.8757V29.6225H50.1726L49.5039 28.8757H0Z" fill="white"/>
            <path d="M0 4.23308H49.506L50.1726 3.48633H0V4.23308Z" fill="white"/>
            <text transform="translate(19.7129 7.40234)" fill="#1F1C24" xml:space="preserve" style="white-space: pre" text-anchor="middle" alignment-baseline="middle" font-family="Open Sans" font-size="14px" font-weight="bold" letter-spacing="0.01em"><tspan x="-1.76913" y="14.4312">${row.rank}</tspan></text>
            </g><defs><clipPath id="clip0_221_6253"><rect width="51.791" height="32.1104" fill="white" transform="translate(0 0.5)"/></clipPath></defs></svg><h5>${row.institute}<br><span>${row.program_name}</span></h5></div><span class="badge">${row.sector}</span></div><div class="progress"><div class="d-flex jc-space-b"><p>Overall Score (1,000)</p><p class="score">${row.score}</p></div><div class="progress-wrapper"><div class="progress-bar" style="width:${insertDecimal(row.score)}%"></div></div></div></div> `
        }
      },
    ],
  });

  $('#ex-mba-table').DataTable({
    responsive: true,
    processing: true,
    searching: false,
    bInfo: false,
    "ordering": false,
    "bLengthChange": false,
    scrollX: true,
    'pageLength': itemsPerPage,
    language: {
      searchPlaceholder: "Search here",
      search: "",
      paginate: {
        next: '<img src="assets/img/right-arrow-dark.png" class="arrow right">',
        previous: '<img src="assets/img/right-arrow-dark.png" class="arrow left">',
      },
    },
    data: exMbaSchools,
    columns: [
      {
        render: (data, type, row) => {
          return `<div class="school-detail"><div class="d-flex ai-center jc-space-b"><div class="d-flex ai-center"><svg class="rank" width="52" height="33" viewBox="0 0 52 33" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g clip-path="url(#clip0_221_6253)"><path d="M0 0.5V32.6104H51.791L42.8895 16.5552L51.791 0.5H0Z" fill="#D3C375"/><path d="M0 28.8757V29.6225H50.1726L49.5039 28.8757H0Z" fill="white"/>
              <path d="M0 4.23308H49.506L50.1726 3.48633H0V4.23308Z" fill="white"/>
              <text transform="translate(19.7129 7.40234)" fill="#1F1C24" xml:space="preserve" style="white-space: pre" text-anchor="middle" alignment-baseline="middle" font-family="Open Sans" font-size="14px" font-weight="bold" letter-spacing="0.01em"><tspan x="-1.76913" y="14.4312">${row.rank}</tspan></text>
              </g><defs><clipPath id="clip0_221_6253"><rect width="51.791" height="32.1104" fill="white" transform="translate(0 0.5)"/></clipPath></defs></svg><h5>${row.institute}<br><span>${row.program_name}</span></h5></div><span class="badge">${row.sector}</span></div><div class="progress"><div class="d-flex jc-space-b"><p>Overall Score (1,000)</p><p class="score">${row.score}</p></div><div class="progress-wrapper"><div class="progress-bar" style="width:${insertDecimal(row.score)}%"></div></div></div></div> `
        }
      },
    ],
  });

  $('#one-mba').on('click', () => {
    $('.ranking-data-wrapper').addClass('d-none')
    $('.ranking-data-wrapper.ex-mba').removeClass('d-none')
  })
  $('#ex-mba').on('click', () => {
    $('.ranking-data-wrapper').removeClass('d-none')
    $('.ranking-data-wrapper.ex-mba').addClass('d-none')
  })

}

mbaRankingInit()



async function rankingInit() {
  const rankingData = await d3.csv("assets/data/report.csv");
  const table = d3.select('.ranking-data .ranking-data-wrapper').append('table').attr('id', 'ranking-table').attr('class', 'full-width')
  const thead = table.append('thead')
  const tbody = table.append('tbody')
  thead.append('tr').append('th')
  const rows = tbody.append('tr').append('td')

  let itemsPerPage = 5;

  function insertDecimal(num) {
    return Number((num / 10));
  }


  $('#select-ranking-year').select2({ minimumResultsForSearch: Infinity });
  $('#select-ranking-sector').select2({ minimumResultsForSearch: Infinity }).on('change', function (e) {
    if ($(this).val() === 'Government') {
      let filteredData = rankingData.filter(d => d.sector == 'G')
      rankingData.push(...filteredData)
      console.log(filteredData)
      console.log(rankingData)
    }
  });
  let sym = [];
  $('#ranking-table').DataTable({
    responsive: true,
    processing: true,
    bInfo: false,
    "ordering": false,
    "bLengthChange": false,
    scrollX: true,
    'pageLength': itemsPerPage,
    language: {
      searchPlaceholder: "Search here",
      search: "",
      paginate: {
        next: '<img src="assets/img/right-arrow.png" class="arrow right">',
        previous: '<img src="assets/img/right-arrow.png" class="arrow left">',
      },
    },
    data: rankingData,
    columns: [
      {
        render: (data, type, row) => {
          return `<div class="school-detail"><div class="d-flex ai-center jc-space-b"><div class="d-flex ai-center"><svg class="rank" width="52" height="33" viewBox="0 0 52 33" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_221_6253)"><path d="M0 0.5V32.6104H51.791L42.8895 16.5552L51.791 0.5H0Z" fill="#D3C375"/><path d="M0 28.8757V29.6225H50.1726L49.5039 28.8757H0Z" fill="white"/>
            <path d="M0 4.23308H49.506L50.1726 3.48633H0V4.23308Z" fill="white"/>
            <text transform="translate(19.7129 7.40234)" fill="#1F1C24" xml:space="preserve" style="white-space: pre" text-anchor="middle" alignment-baseline="middle" font-family="Open Sans" font-size="14px" font-weight="bold" letter-spacing="0.01em"><tspan x="-1.76913" y="14.4312">${row.rank}</tspan></text>
            </g><defs><clipPath id="clip0_221_6253"><rect width="51.791" height="32.1104" fill="white" transform="translate(0 0.5)"/></clipPath></defs></svg>
            <h5>${row.institute}</h5></div><span class="badge">${changeName(row.sector)} </span></div><div class="progress"><div class="d-flex jc-space-b"><p>Overall Score (1,000)</p><p class="score">${row.score}</p></div><div class="progress-wrapper"><div class="progress-bar" style="width:${insertDecimal(row.score)}%"></div></div></div></div> `
        }
      },
    ],
  });
}

rankingInit();   